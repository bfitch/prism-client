{"version":3,"sources":["../../../src/actions/delete-action.js"],"names":["deleteAction","entityName","UrlBuilder","http","store","loader","serialize","normalize","resetForceFetch","update","opts","resolvers","args","context","_","url","options","forceFetch","clearCache","variables","request","method","href","params","headers","data","then","res","entities","result","obj","delete","id","clearUrls","cache"],"mappings":";;AAAA,OAAO,SAASA,YAAT,CAAsB;AAC3BC,YAD2B;AAE3BC,YAF2B;AAG3BC,MAH2B;AAI3BC,OAJ2B;AAK3BC,QAL2B;AAM3BC,WAN2B;AAO3BC,WAP2B;AAQ3BC,iBAR2B;AAS3BC;AAT2B,CAAtB,EAUJC,IAVI,EAUE;;AAEP,SAAO,CAACC,SAAD,EAAYC,IAAZ,EAAkBC,OAAlB,EAA2BC,CAA3B,KAAiC;AACtC,UAAMC,MAAM,IAAIb,UAAJ,CAAeS,SAAf,EAA0BC,IAA1B,EAAgCF,IAAhC,CAAZ;AACA,UAAM,EAAEM,SAAS,EAAEC,aAAa,KAAf,EAAsBC,aAAa,KAAnC,KAA6C,EAAxD,KAA6EN,IAAnF;AAAA,UAAqEO,SAArE,4BAAmFP,IAAnF;;AAEA,QAAIM,UAAJ,EAAgBd,MAAMc,UAAN;;AAEhB,UAAME,UAAUjB,KAAK;AACnBkB,cAAQ,QADW;AAEnBN,WAAKA,IAAIO,IAFU;AAGnBC,cAAQR,IAAIQ,MAHO;AAInBC,eAAST,IAAIS,OAJM;AAKnBC,YAAMnB,UAAUa,SAAV;AALa,KAAL,CAAhB;;AAQA,WAAOC,QAAQM,IAAR,CAAaC,OAAO;AACzB,YAAM,EAAEC,QAAF,EAAYC,MAAZ,KAAuBtB,UAAUoB,GAAV,EAAe,EAAEG,KAAKnB,SAAP,EAAkBC,MAAMO,SAAxB,EAAf,CAA7B;;AAEAf,YAAM2B,MAAN,CAAa9B,UAAb,EAAyBc,IAAIiB,EAA7B;;AAEA3B,aAAO4B,SAAP;AACAzB,sBAAgBS,UAAhB;;AAEAR,aAAOL,MAAM8B,KAAb,EAAoBtB,IAApB;AACA,aAAOgB,SAAS3B,UAAT,EAAqB4B,MAArB,KAAgC,EAAvC;AACD,KAVM,CAAP;AAWD,GAzBD;AA0BD","file":"delete-action.js","sourcesContent":["export function deleteAction({\n  entityName,\n  UrlBuilder,\n  http,\n  store,\n  loader,\n  serialize,\n  normalize,\n  resetForceFetch,\n  update\n}, opts) {\n\n  return (resolvers, args, context, _) => {\n    const url = new UrlBuilder(resolvers, args, opts);\n    const { options: { forceFetch = false, clearCache = false } = {}, ...variables } = args;\n\n    if (clearCache) store.clearCache();\n\n    const request = http({\n      method: 'delete',\n      url: url.href,\n      params: url.params,\n      headers: url.headers,\n      data: serialize(variables)\n    });\n\n    return request.then(res => {\n      const { entities, result } = normalize(res, { obj: resolvers, args: variables });\n\n      store.delete(entityName, url.id);\n\n      loader.clearUrls();\n      resetForceFetch(forceFetch);\n\n      update(store.cache, args);\n      return entities[entityName][result] || {};\n    });\n  }\n}\n"]}