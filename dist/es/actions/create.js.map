{"version":3,"sources":["../../../src/actions/create.js"],"names":["create","entityName","UrlBuilder","http","store","loader","serialize","normalize","resetForceFetch","update","opts","resolvers","args","context","_","url","options","forceFetch","clearCache","variables","request","method","href","params","headers","data","then","res","entities","result","set","clearUrls","entity","cache"],"mappings":";;AAAA,eAAe,SAASA,MAAT,CAAgB;AAC7BC,YAD6B;AAE7BC,YAF6B;AAG7BC,MAH6B;AAI7BC,OAJ6B;AAK7BC,QAL6B;AAM7BC,WAN6B;AAO7BC,WAP6B;AAQ7BC,iBAR6B;AAS7BC;AAT6B,CAAhB,EAUZC,IAVY,EAUN;;AAEP,SAAO,CAACC,SAAD,EAAYC,IAAZ,EAAkBC,OAAlB,EAA2BC,CAA3B,KAAiC;AACtC,UAAMC,MAAM,IAAIb,UAAJ,CAAeS,SAAf,EAA0BC,IAA1B,EAAgCF,KAAKK,GAArC,CAAZ;AACA,UAAM,EAAEC,SAAS,EAAEC,aAAa,KAAf,EAAsBC,aAAa,KAAnC,KAA6C,EAAxD,KAA6EN,IAAnF;AAAA,UAAqEO,SAArE,4BAAmFP,IAAnF;;AAEA,QAAIM,UAAJ,EAAgBd,MAAMc,UAAN;;AAEhB,UAAME,UAAUjB,KAAK;AACnBkB,cAAQ,MADW;AAEnBN,WAAKA,IAAIO,IAFU;AAGnBC,cAAQR,IAAIQ,MAHO;AAInBC,eAAST,IAAIS,OAJM;AAKnBC,YAAMnB,UAAUa,SAAV;AALa,KAAL,CAAhB;;AAQA,WAAOC,QAAQM,IAAR,CAAaC,OAAO;AACzB,YAAM,EAAEC,QAAF,EAAYC,MAAZ,KAAuBtB,UAAUoB,GAAV,EAAehB,SAAf,EAA0BQ,SAA1B,CAA7B;AACAf,YAAM0B,GAAN,CAAUF,QAAV;;AAEAvB,aAAO0B,SAAP;AACAvB,sBAAgBS,UAAhB;;AAEA,YAAMe,SAASJ,SAAS3B,UAAT,EAAqB4B,MAArB,CAAf;AACApB,aAAOL,MAAM6B,KAAb,EAAoBD,MAApB;;AAEA,aAAOA,MAAP;AACD,KAXM,CAAP;AAYD,GA1BD;AA4BD","file":"create.js","sourcesContent":["export default function create({\n  entityName,\n  UrlBuilder,\n  http,\n  store,\n  loader,\n  serialize,\n  normalize,\n  resetForceFetch,\n  update\n}, opts) {\n\n  return (resolvers, args, context, _) => {\n    const url = new UrlBuilder(resolvers, args, opts.url);\n    const { options: { forceFetch = false, clearCache = false } = {}, ...variables } = args;\n\n    if (clearCache) store.clearCache();\n\n    const request = http({\n      method: 'post',\n      url: url.href,\n      params: url.params,\n      headers: url.headers,\n      data: serialize(variables)\n    });\n\n    return request.then(res => {\n      const { entities, result } = normalize(res, resolvers, variables);\n      store.set(entities);\n\n      loader.clearUrls();\n      resetForceFetch(forceFetch);\n\n      const entity = entities[entityName][result];\n      update(store.cache, entity);\n\n      return entity;\n    });\n  }\n\n}\n"]}