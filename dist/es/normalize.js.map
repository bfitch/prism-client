{"version":3,"sources":["../../src/normalize.js"],"names":["camelizeCollection","camelizeKeys","normalize","schema","isArray","Array","Normalizer","entityName","opts","normalizeFn","defaultNormalize","parse","res","data","store","cache","obj","args","camelizer","Entity"],"mappings":"AAAA,SAASA,kBAAT,EAA6BC,YAA7B,QAAiD,kBAAjD;AACA,SAASC,SAAT,EAAoBC,MAApB,QAAkC,WAAlC;AACA,MAAM,EAAEC,OAAF,KAAcC,KAApB;;AAEA,eAAe,SAASC,UAAT,CAAoBC,UAApB,EAAgCC,IAAhC,EAAsC;AACnD,QAAMC,cAAcD,KAAKN,SAAL,IAAkBQ,iBAAiBH,UAAjB,CAAtC;AACA,QAAMI,QAAcH,KAAKG,KAAL,KAAoBC,GAAD,IAASA,IAAIC,IAAhC,CAApB;AACA,QAAMC,QAAcN,KAAKM,KAAL,CAAWC,KAA/B;;AAEA,SAAO,UAASH,GAAT,EAAc,EAAEI,GAAF,EAAOC,IAAP,EAAd,EAA6B;AAClC,UAAMJ,OAAOF,MAAMC,GAAN,CAAb;AACA,WAAOV,UAAUgB,UAAUL,IAAV,CAAV,EAA2BJ,YAAYI,IAAZ,EAAkB,EAAEG,GAAF,EAAOC,IAAP,EAAaH,KAAb,EAAlB,CAA3B,CAAP;AACD,GAHD;AAID;;AAED,SAASI,SAAT,CAAmBL,IAAnB,EAAyB;AACvB,SAAOT,QAAQS,IAAR,IAAgBb,mBAAmBa,IAAnB,CAAhB,GAA2CZ,aAAaY,IAAb,CAAlD;AACD;;AAED,SAASH,gBAAT,CAA0BH,UAA1B,EAAsC;AACpC,SAAO,CAACM,IAAD,EAAO,EAAEG,GAAF,EAAOC,IAAP,EAAP,KAAyBb,QAAQS,IAAR,IAAgB,CAAE,IAAIV,OAAOgB,MAAX,CAAkBZ,UAAlB,CAAF,CAAhB,GAAoD,IAAIJ,OAAOgB,MAAX,CAAkBZ,UAAlB,CAApF;AACD","file":"normalize.js","sourcesContent":["import { camelizeCollection, camelizeKeys } from './utils/camelize';\nimport { normalize, schema } from 'normalizr';\nconst { isArray } = Array;\n\nexport default function Normalizer(entityName, opts) {\n  const normalizeFn = opts.normalize || defaultNormalize(entityName);\n  const parse       = opts.parse     || ((res) => res.data);\n  const store       = opts.store.cache;\n\n  return function(res, { obj, args }) {\n    const data = parse(res);\n    return normalize(camelizer(data), normalizeFn(data, { obj, args, store }));\n  }\n}\n\nfunction camelizer(data) {\n  return isArray(data) ? camelizeCollection(data) : camelizeKeys(data);\n}\n\nfunction defaultNormalize(entityName) {\n  return (data, { obj, args }) => isArray(data) ? [ new schema.Entity(entityName) ] : new schema.Entity(entityName)\n}\n"]}